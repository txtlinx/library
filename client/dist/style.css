:root {
  --bg: #020617;
  --panel: #081122;
  --panel-2: #060d1b;
  --border: #1e3a8a;
  --border-2: #1d4ed8;
  --text: #e2e8f0;
  --muted: #93c5fd;
  --shadow: 0 14px 34px rgba(0,0,0,0.45);
  --radius: 12px;
  --radius-sm: 8px;
  --space: 12px;
  --primary: #3b82f6;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --neutral: #6b7280;
}

html, body { background: var(--bg); color: var(--text); }

body {
  font-family: 'Space Grotesk', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  background-image:
    radial-gradient(circle at 12% 18%, rgba(14,116,144,0.18), transparent 38%),
    radial-gradient(circle at 88% 10%, rgba(30,64,175,0.16), transparent 36%),
    linear-gradient(180deg, #020617 0%, #030a18 100%);
  background-attachment: fixed;
}
html { font-size: 16px; }
.container {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  padding: var(--space);
  background: linear-gradient(180deg, rgba(8,17,34,0.94), rgba(6,13,27,0.96));
  border-radius: 12px;
  border: 1px solid rgba(56,189,248,0.2);
  box-shadow: 0 14px 34px rgba(0,0,0,0.45), 0 0 0 1px rgba(30,64,175,0.22) inset;
}
h1 { margin-top: 0; color: #f8fafc; font-size: 30px; letter-spacing: 0.2px; }
h2 { font-size: 22px; margin-top: 0; margin-bottom: 10px; color: #e5e7eb; letter-spacing: 0.2px; }
form input, form textarea { width: 100%; padding: 8px; margin-top: 6px; margin-bottom: 12px; border: 1px solid #334155; border-radius: 6px; background: #0b1220; color: #e5e7eb; }
button { background: linear-gradient(135deg,#2563eb,#1d4ed8); color: white; padding: 8px 12px; border: 1px solid rgba(125,211,252,0.35); border-radius: 10px; cursor: pointer; font-size: 15px; padding: 10px 14px; transition: background-color 160ms ease, transform 120ms ease, box-shadow 160ms ease; }
button:hover { background: linear-gradient(135deg,#0ea5e9,#2563eb); box-shadow: 0 8px 20px rgba(2,132,199,0.3); }
button:active { transform: translateY(1px); }
ul { list-style: none; padding-left: 0; margin: 0; }
li { padding: 18px; border: 1px solid rgba(30,64,175,0.55); border-radius: 12px; background: linear-gradient(180deg,#0b1220,#0a1325); transition: border-color 160ms ease, box-shadow 160ms ease, transform 120ms ease; }
li:hover { border-color: rgba(56,189,248,0.55); box-shadow: 0 8px 22px rgba(2,132,199,0.22); }
small { color: #cbd5e1; font-size: 13px; }

/* Inputs y selects acorde al tema oscuro */
input[type="text"],
input[type="number"],
input[type="date"],
input[type="datetime-local"],
input[type="file"],
select,
textarea {
  width: 100%;
  padding: 8px;
  margin-top: 6px;
  margin-bottom: 12px;
  border: 1px solid #3b445a; /* gris azulado oscuro */
  border-radius: 6px;
  background: #0b1220; /* fondo oscuro */
  color: #e5e7eb; /* texto claro */
  font-size: 15px;
  padding: 10px;
}

/* Icono del selector de calendario en datetime-local acorde a tema oscuro */
input[type="datetime-local"] {
  color-scheme: dark;
}
input[type="datetime-local"]::-webkit-calendar-picker-indicator {
  filter: invert(1) brightness(1.2);
  opacity: 0.9;
}
/* Para Firefox (no permite mucho estilo en indicador), asegurar contraste del texto */
input[type="datetime-local"]::-moz-placeholder { color: #9ca3af; }

select { cursor: pointer; }

input::placeholder,
textarea::placeholder { color: #9ca3af; }

input:focus,
textarea:focus,
select:focus {
  outline: none;
  border-color: #38bdf8;
  box-shadow: 0 10px 24px rgba(2,132,199,0.28), 0 0 0 1px rgba(125,211,252,0.3) inset, 0 0 0 3px rgba(14,165,233,0.2);
}

/* Inputs utilitarios (filtros, búsquedas, selects) */
.input {
  width: 100%;
  box-sizing: border-box;
  min-height: 38px;
  padding: 8px 10px;
  border: 1px solid #0ea5e9;
  border-radius: 10px;
  background: linear-gradient(180deg, rgba(11,18,32,1), rgba(7,15,30,1));
  color: #f0f9ff;
  box-shadow: 0 1px 0 rgba(125, 211, 252, 0.14) inset;
}
.input:focus {
  outline: none;
  border-color: #38bdf8;
  box-shadow: 0 10px 24px rgba(2,132,199,0.35), 0 0 0 1px rgba(125,211,252,0.35) inset, 0 0 0 3px rgba(14,165,233,0.22);
}

.card { border: 1px solid rgba(30,64,175,0.5); border-radius: 12px; background: linear-gradient(180deg, #0b1220, #0a1325); box-shadow: 0 10px 24px rgba(0,0,0,0.35); }

label { color: #e5e7eb; display: block; font-weight: 600; margin-bottom: 6px; }

/* Ajustes puntuales de buscadores ya existentes */
#search,
#task-search { background: #0b1220; color: #e5e7eb; border: 1px solid #334155; }

#client-info {
  margin-bottom: 12px;
  padding: 10px;
  background: #0b1220; /* oscuro acorde */
  border: 1px solid #1f2937;
  border-radius: 8px;
}
#client-info strong { color: #e5e7eb; font-weight: 700; }
#client-info span { color: #cbd5e1; font-size: 14px; }

.created-date { display: block; color: #9ca3af; font-size: 12px; margin-top: 4px; font-weight: 500; letter-spacing: .1px; }

.thumbnails { display: flex; gap: 8px; flex-wrap: wrap; overflow: hidden; max-height: 0; opacity: 0; transition: max-height 300ms cubic-bezier(.2,.8,.2,1), opacity 250ms ease; }
.thumbnails.visible { max-height: 600px; opacity: 1; }
.thumb { width: 80px; height: 60px; object-fit: cover; border-radius: 6px; border: 1px solid #3b445a; transition: transform 180ms ease, box-shadow 180ms ease; }
.thumb:hover { transform: scale(1.06); box-shadow: 0 6px 18px rgba(0,0,0,0.5); }
.button-toggle-images { transition: background-color 160ms ease, transform 160ms ease; border-radius: 6px; }
.button-toggle-images:active { transform: scale(0.98); }

.collapsible { overflow: hidden; max-height: 0; opacity: 0; transition: max-height 300ms cubic-bezier(.2,.8,.2,1), opacity 250ms ease; }
.collapsible.expanded { max-height: 10000px; opacity: 1; overflow: visible; }

/* Estado colapsado explícito para listas plegables */
.collapsible.collapsed {
  max-height: 0 !important;
  opacity: 0 !important;
  overflow: hidden !important;
}

.toggle-list-btn { background: #374151; margin-left: 8px; border-radius: 6px; }

#tasks-calendar-btn { color: #ffffff; }

/* Separación mayor entre tareas */
#tasks li {
  padding: 18px;
  margin-bottom: 16px;
  border: 1px solid #1f2937;
  border-radius: 8px;
  background: #0b1220;
  transition: border-color 160ms ease, box-shadow 160ms ease, transform 120ms ease;
}
#tasks li:hover { border-color: #334155; box-shadow: 0 6px 18px rgba(0,0,0,0.45); }

/* Más espacio entre ítems de listas */
#errors li,
#tasks li {
  padding: 18px;
  margin-bottom: 16px;
  font-size: 16px;
  line-height: 1.6;
}

/* Separar bloques principales */
#errors-section,
#tasks-section {
  margin-top: 20px;
}

.actions-row { display: flex; align-items: center; gap: 10px; }
.actions-row .btn-update-apart { margin-left: auto; }

/* Alertas de tareas */
.task-alert {
  display: inline-block;
  padding: 6px 10px;
  border-radius: 6px;
  font-size: 13px;
  margin-bottom: 8px;
}
.task-alert.start-soon { background: #1f2937; border: 1px solid #3b82f6; color: #e0f2fe; }
.task-alert.end-soon { background: #1f2937; border: 1px solid #ef4444; color: #fee2e2; }

/* Animaciones para alertas */
@keyframes alert-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}
@keyframes alert-pulse {
  0% { box-shadow: 0 0 0 0 rgba(239,68,68,0.7); }
  70% { box-shadow: 0 0 0 14px rgba(239,68,68,0); }
  100% { box-shadow: 0 0 0 0 rgba(239,68,68,0); }
}
.task-alert.start-soon { animation: alert-bounce 0.9s ease-in-out infinite; }
.task-alert.end-soon { animation: alert-pulse 1.0s ease-out infinite; }

/* Badge de estado en tareas */
.status-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 999px;
  font-size: 12px;
  margin: 2px 0;
  box-shadow: 0 2px 6px rgba(0,0,0,0.25);
}
/* En proceso: azul */
.status-in-progress {
  background: #3b82f6; /* blue */
  color: #0b2a5b; /* deep blue text for contrast */
  border: 1px solid #2563eb;
}
/* Detenida: naranja */
.status-paused {
  background: #f59e0b; /* orange */
  color: #1f2937; /* dark text */
  border: 1px solid #d97706;
}
/* Terminada: verde */
.status-completed {
  background: #10b981; /* green */
  color: #052e2b; /* deep green text */
  border: 1px solid #059669;
}

/* Reloj descendente para tareas en progreso */
.countdown {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 4px 8px;
  background: #0b1220;
  border: 1px solid #3b82f6;
  color: #dbeafe;
  border-radius: 999px;
  font-size: 12px;
}
.countdown .dot { width: 6px; height: 6px; border-radius: 50%; background: #3b82f6; animation: pulse-dot 1.2s ease-in-out infinite; }
@keyframes pulse-dot { 0%,100% { transform: scale(1); } 50% { transform: scale(1.5); } }

/* Topbar marquee: smoother motion on big screens */
@media (min-width: 768px) {
  .marquee-track { animation-duration: 36s; }
}

/* Responsive container & forms */
@media (max-width: 640px) {
  .container { padding: 20px; }
  h1 { font-size: 26px; }
  h2 { font-size: 20px; }
  button { font-size: 14px; }
}

/* Calendar modal grid: larger tap targets */
#cal-grid > div { padding: 10px; border-radius: 6px; background: #0b1220; border: 1px solid #1f2937; }
#cal-grid > div.has-tasks { border-color: #ef4444; color: #fee2e2; }

/* Payments list alignment */
#payments li { padding: 18px; }

/* Payments summary layout tweaks */
.payments-summary-box { width: 100%; }
.payments-summary { display:flex; gap:10px; align-items:flex-start; width:100%; justify-content:space-between; flex-wrap: wrap; }
.canvas-wrap { flex: 1 1 520px; min-width: 280px; padding: 8px; background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); }
.legend { flex: 1 1 240px; min-width: 220px; display:flex; flex-direction:column; gap:8px; }
.legend-item { display:flex; align-items:center; gap:8px; padding:8px 10px; border:1px solid var(--border); border-radius:10px; background: var(--panel); box-shadow: 0 4px 14px rgba(0,0,0,0.25); justify-content:space-between; }
.legend-label { color: var(--muted); font-size: 12px; }
.legend-value { color: var(--text); font-weight: 700; margin-left:auto; text-align:right; min-width: 120px; }

@media (max-width: 860px) {
  .payments-summary { gap: 8px; }
  .canvas-wrap { flex: 1 1 100%; min-width: 100%; }
  .legend { flex: 1 1 100%; min-width: 100%; display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 8px; }
  .legend-item { padding: 8px; }
}

@media (max-width: 480px) {
  .legend { grid-template-columns: 1fr; }
  .legend-item { display:flex; flex-wrap: nowrap; }
  .legend-label { font-size: 12px; }
  .legend-value { font-size: 15px; }
}

/* Confirm modal */
.modal-overlay { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(2, 6, 23, 0.72); backdrop-filter: saturate(120%) blur(2px); z-index: 10000; }
.modal-overlay.show { display: flex; }
.confirm-modal { background: #111827; color: #e5e7eb; width: min(92vw, 440px); border-radius: 12px; border: 1px solid #1f2937; box-shadow: 0 18px 60px rgba(0,0,0,0.55); overflow: hidden; animation: modal-pop 160ms ease-out; }
.confirm-modal .modal-header { padding: 14px 16px; border-bottom: 1px solid #1f2937; font-weight: 700; letter-spacing: 0.2px; color: #f8fafc; }
.confirm-modal .modal-body { padding: 16px; font-size: 15px; color: #e5e7eb; }
.confirm-modal .modal-actions { padding: 12px 16px; border-top: 1px solid #1f2937; display: flex; gap: 8px; justify-content: flex-end; }
.confirm-modal .btn-cancel { background: #374151; color: #e5e7eb; border-radius: 8px; padding: 8px 12px; }
.confirm-modal .btn-cancel:hover { background: #314055; }
.confirm-modal .btn-danger { background: #ef4444; color: #fff; border-radius: 8px; padding: 8px 12px; }
.confirm-modal .btn-danger:hover { background: #dc2626; }

/* Visually align filter rows across sections */
.filters-row { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
.filters-row label { display: inline-flex; align-items: center; gap: 8px; margin: 0; }
.filters-row select,
.filters-row input[type="text"],
.filters-row input[type="number"],
.filters-row input[type="month"] {
  height: 36px;
  padding: 6px 10px;
}
.filters-row button { height: 36px; padding: 6px 10px; }

/* Compact filters: align controls on a single line */
.filters-row {
  display: flex;
  flex-wrap: nowrap; /* force single line; horizontal scroll if overflow */
  align-items: center;
  gap: 8px;
  overflow-x: auto;
  padding: 4px 0;
}
.filters-row label {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  white-space: nowrap;
  margin: 0; /* remove extra spacing */
}
.filters-row select,
.filters-row input[type="text"],
.filters-row input[type="number"],
.filters-row input[type="month"] {
  font-size: 12px;
  padding: 4px 6px;
  height: 28px;
  border-radius: 6px;
  max-width: 140px; /* shrink inputs so all fit */
}
.filters-row button {
  font-size: 12px;
  padding: 4px 6px;
  height: 28px;
  border-radius: 6px;
}

/* Optional: smaller search inputs to match compact filters */
#search,
#task-search,
#payments-search,
#payment-search {
  font-size: 13px;
  padding: 6px 8px;
}

@keyframes modal-pop { from { opacity: 0; transform: translateY(6px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); }
}

/* Align legend with chart: add vertical breathing space */
.legend { margin-top: 8px; }
.legend-item { margin-bottom: 4px; }

/* Make the payments list match the summary box styling and width */
#payments {
  width: 100%;
  background: #0a0f1e;
  border: 1px solid #1f2937;
  border-radius: 12px;
  padding: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
}

/* Ensure spacing between payments box and summary box */
#payments + .payments-summary-box { margin-top: 12px; }

/* Tasks board columns and task cards */
.tasks-board { display: grid; grid-template-columns: repeat(12, 1fr); gap: 10px; margin-top: 12px; }
.tasks-hour { background: #0b1220; border: 1px solid #1f2937; border-radius: 10px; min-height: 180px; padding: 8px; box-shadow: 0 6px 18px rgba(0,0,0,0.3); display:flex; flex-direction:column; gap:8px; }
.tasks-hour-header { display:flex; align-items:center; justify-content:space-between; color:#cbd5e1; font-weight:600; font-size:13px; margin-bottom:4px; }
.tasks-hour-drop { flex:1; display:flex; flex-direction:column; gap:8px; }
.task-card { position: relative; background:#0f172a; border:1px solid #374151; border-radius:10px; padding:8px 10px; color:#e5e7eb; box-shadow:0 8px 24px rgba(0,0,0,0.35); display:flex; flex-direction:column; gap:6px; }
.task-card-title { font-weight:700; font-size:14px; }
.task-card-meta { display:flex; align-items:center; justify-content:space-between; font-size:12px; color:#94a3b8; }
.task-card-tags { font-size:11px; color:#9ca3af; }
.task-card-edit { position:absolute; right:8px; top:8px; background:#374151; color:#e5e7eb; border:none; border-radius:6px; padding:4px 6px; cursor:pointer; font-size:12px; }
.task-card-edit:hover { background:#4b5563; }
.sortable-ghost { opacity: 0.6; }
.sortable-drag { cursor: grabbing; }

/* Alineación uniforme para el modal de formulario */
.form-modal label {
  display: block;
  font-size: 0.95rem;
  color: #e5e7eb;
  margin-top: 8px;
}
.form-modal input[type="text"],
.form-modal input[type="file"],
.form-modal textarea {
  width: 100%;
  box-sizing: border-box;
  margin-top: 6px;
  margin-bottom: 10px;
  padding: 8px 10px;
  border: 1px solid #1f2937;
  border-radius: 8px;
  background: #0b1220;
  color: #e5e7eb;
}
.form-modal textarea { resize: vertical; }

/* Modo censura: oculta textos sensibles */
.censored .sensitive,
.censored .message,
.censored .solution {
  filter: blur(6px);
}

/* Toasts */
.toast { position: fixed; right: 16px; bottom: 16px; background: var(--panel-2); border: 1px solid var(--border); color: var(--text); padding: 10px 12px; border-radius: var(--radius-sm); box-shadow: var(--shadow); z-index: 10010; }

/* Skeletons */
.skeleton { background: linear-gradient(90deg, #0a0f1e 0%, #0e1726 50%, #0a0f1e 100%); background-size: 200% 100%; animation: shimmer 1.2s ease-in-out infinite; border-radius: var(--radius-sm); }
@keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

/* Mobile-first hardening */
@media (max-width: 900px) {
  body { padding: 10px; }
  .topbar { padding: 10px !important; }
  .tabs { flex-wrap: wrap; gap: 8px !important; }
  .tab-btn { padding: 7px 10px !important; font-size: 13px; }
  .container { padding: 10px !important; border-radius: 10px; }

  h1 { font-size: 24px; margin-bottom: 10px; }
  h2 { font-size: 20px; }

  /* Keep action bars usable */
  #tasks-pagination,
  #payments-pagination,
  #notes-pagination,
  #errors-pagination {
    flex-wrap: wrap !important;
    align-items: center !important;
    gap: 8px !important;
  }
  #tasks-pagination label,
  #payments-pagination label,
  #notes-pagination label,
  #errors-pagination label {
    margin-left: 0 !important;
    width: 100%;
  }
  #tasks-search-any,
  #payments-search-any,
  #notes-search-any {
    min-width: 0 !important;
    max-width: none !important;
    width: 100% !important;
  }
  #tasks-sort,
  #tasks-page-size,
  #payments-page-size,
  #notes-page-size,
  #errors-page-size {
    width: 100% !important;
    max-width: none !important;
    min-width: 0 !important;
  }

  /* Cards and lists */
  ul#errors, ul#tasks, ul#payments, ul#notes { padding: 8px !important; }
  li { padding: 12px !important; margin-bottom: 10px !important; }

  /* Keep headings with many inline buttons readable */
  #tasks-section h2,
  #payments-section h2,
  #notes-section h2,
  #errors-section h2 {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 8px !important;
    align-items: center !important;
  }
  #tasks-section h2 button,
  #payments-section h2 button,
  #notes-section h2 button,
  #errors-section h2 button {
    margin-left: 0 !important;
  }

  /* Week view / banks / summary */
  #week-view-container { padding: 8px !important; }
  #week-view > div { grid-template-columns: 1fr !important; gap: 10px !important; }
  #payments-banks-list { grid-template-columns: 1fr !important; }
  .payments-summary { display: block !important; }
  .canvas-wrap, .legend { width: 100% !important; min-width: 0 !important; }

  /* Calendar modal */
  #tasks-calendar-modal { padding: 6px !important; }
  #tasks-calendar-modal > div {
    width: 100% !important;
    max-height: 94vh !important;
    padding: 10px !important;
  }
  #cal-grid-wrap { max-height: 66vh !important; }

  /* Form modal */
  #form-overlay .form-modal {
    width: 96% !important;
    max-height: 92vh !important;
    padding: 12px !important;
  }
}

@media (max-width: 480px) {
  body { padding: 8px; }
  .container { padding: 8px !important; border-radius: 8px; }
  h1 { font-size: 20px; }
  h2 { font-size: 17px; }

  .tab-btn,
  .subtab-btn,
  button,
  .btn {
    font-size: 12px !important;
    padding: 6px 8px !important;
    border-radius: 8px !important;
  }

  label { font-size: 12px; }
  input, textarea, select { font-size: 13px !important; }

  #tasks-pagination,
  #payments-pagination,
  #notes-pagination,
  #errors-pagination {
    gap: 6px !important;
  }

  .legend-item { padding: 6px 8px !important; }
  .legend-label { font-size: 11px !important; }
  .legend-value { font-size: 13px !important; min-width: 0 !important; }

  #tasks-calendar-modal > div { padding: 8px !important; }
  #cal-grid-wrap { max-height: 62vh !important; }
}
